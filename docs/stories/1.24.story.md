# Story 1.24: Multi-Currency Table View Enhancement

## Status
Ready for Review

## Story
**As a** user viewing keys in table mode,
**I want** to see multi-currency balance information in expandable rows,
**so that** I can efficiently review cryptocurrency data in a compact format.

## Acceptance Criteria

### Task 1: Table Row Multi-Currency Foundation
- [x] Enhance UltraOptimizedDashboard table rows to display multi-currency data
- [x] Add currency-specific balance columns with appropriate icons
- [x] Implement expandable row sections showing detailed currency breakdowns
- [x] Display total balance aggregation across all supported currencies

### Task 2: Performance and Visual Design
- [x] Maintain existing table virtualization and performance characteristics
- [x] Add currency-specific fund indicators and highlighting
- [x] Ensure table responsiveness with additional currency columns
- [x] Implement proper sorting and filtering for multi-currency data

### Task 3: Complete Cryptocurrency Visibility (ENHANCED)
- [x] Ensure expanded table rows display ALL 8 cryptocurrencies with complete address breakdowns
- [x] Implement expandable sub-sections within rows for each cryptocurrency with full address visibility
- [x] Add "Expand All Currencies" toggle for comprehensive multi-currency data display

## Integration Verification
- IV1: Existing table performance and virtualization must be maintained
- IV2: Bitcoin-only table functionality must continue to work
- IV3: Memory usage for large datasets must not exceed 150% of current usage
- IV4: Verify ALL 8 cryptocurrencies are visible and accessible in expanded states
- IV5: Confirm complete address listings for every supported cryptocurrency
- IV6: Validate no cryptocurrency data is hidden or truncated in any expansion view

## Dev Notes

### Multi-Currency Table Architecture
```typescript
interface MultiCurrencyTableRow {
  keyData: KeyWithMultiCurrency;
  expandedCurrencies: Set<CryptoCurrency>;
  showAllCurrencies: boolean;
  onExpandCurrency: (currency: CryptoCurrency) => void;
  onToggleAllCurrencies: () => void;
}
```

### Currency Column Configuration
```typescript
const CURRENCY_COLUMNS = [
  { id: 'BTC', label: 'â‚¿ Bitcoin', icon: 'â‚¿', color: '#f7931a' },
  { id: 'BCH', label: 'ğŸŠ Bitcoin Cash', icon: 'ğŸŠ', color: '#00d4aa' },
  { id: 'DASH', label: 'ğŸ”µ Dash', icon: 'ğŸ”µ', color: '#1c75bc' },
  { id: 'DOGE', label: 'ğŸ• Dogecoin', icon: 'ğŸ•', color: '#c2a633' },
  { id: 'ETH', label: 'âšª Ethereum', icon: 'âšª', color: '#627eea' },
  { id: 'LTC', label: 'ğŸ¥ˆ Litecoin', icon: 'ğŸ¥ˆ', color: '#bfbbbb' },
  { id: 'XRP', label: 'ğŸŒŠ Ripple', icon: 'ğŸŒŠ', color: '#23292f' },
  { id: 'ZEC', label: 'ğŸ›¡ï¸ Zcash', icon: 'ğŸ›¡ï¸', color: '#f4b728' }
];
```

### Expandable Row Requirements
- **All 8 cryptocurrencies must be expandable** within table rows
- **Complete address breakdowns** for each currency in expanded state
- **"Expand All Currencies" toggle** for comprehensive view
- **Sub-sections for each cryptocurrency** with full address visibility
- **No truncation** of cryptocurrency data in any view state

### Performance Considerations
- **Virtual scrolling** must handle expanded multi-currency data efficiently
- **Memory optimization** for large datasets with 8x address information
- **Lazy loading** of expanded currency details when not visible
- **Smooth expansion animations** for enhanced user experience

## Dev Agent Record

### Agent Model Used
- Claude Sonnet 4 (Full Stack Developer - James)

### Debug Log References
- Build successful: âœ“ Compiled successfully 
- TypeScript compilation: No errors
- Fixed server-side multi-currency generation by explicitly requesting all currencies
- Enhanced UltraOptimizedDashboard with comprehensive multi-currency table view
- Implemented currency-specific balance columns with icons for all 8 cryptocurrencies
- Added expandable row sections with detailed currency breakdowns
- Created "Expand All Currencies" toggle for comprehensive data display
- Added individual currency expansion controls within expanded rows
- Implemented total balance aggregation across all supported currencies

### Completion Notes
- âœ… Enhanced server request to explicitly request all 8 currencies for proper multi-currency generation
- âœ… Added currency-specific balance columns with icons (â‚¿ğŸŠğŸ”µğŸ•âšªğŸ¥ˆğŸŒŠğŸ›¡ï¸) for all cryptocurrencies
- âœ… Implemented expandable row sections with detailed currency breakdowns
- âœ… Created total balance aggregation column showing combined balance across all currencies
- âœ… Added "Expand All Currencies" toggle switch for comprehensive multi-currency view
- âœ… Implemented individual currency expansion controls within each expanded row
- âœ… Added expandable sub-sections for each cryptocurrency with complete address visibility
- âœ… Maintained existing table performance characteristics and responsive design
- âœ… Added currency-specific fund indicators and highlighting for funded addresses
- âœ… Ensured ALL 8 cryptocurrencies (BTC, BCH, DASH, DOGE, ETH, LTC, XRP, ZEC) are visible and accessible
- âœ… Implemented proper collapse/expand animations and smooth user experience

### File List
- `apps/web/src/app/page.tsx` - Enhanced server request to explicitly request all currencies
- `apps/web/src/app/components/UltraOptimizedDashboard.tsx` - Complete multi-currency table view implementation with currency columns, expandable rows, and comprehensive controls

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-22 | 1.0 | Initial story creation for multi-currency table view enhancement | Bob (SM) |
| 2025-01-22 | 1.1 | Enhanced with complete cryptocurrency visibility requirements | Bob (SM) |
| 2025-01-22 | 1.2 | Implementation completed - all tasks and subtasks finished with comprehensive multi-currency table view | James (Dev) |

--- 